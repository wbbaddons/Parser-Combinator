{"version":3,"sources":["../../../../src/lib/standard/json/jsonparser.js"],"names":["tkNumber","parser","number","tkString","string","tkKeyword","keyword","tkKey","s","match","arrayOrNothing","value","addValue","concat","e","getValue","item","lazy","expr","map","then","thenRight","optrep","opt","objectOrNothing","attribute","thenLeft","or","thenReturns","parse","source","keywords","tokenizer","generator","tokenBetweenSpaces","builder","chain","eos"],"mappings":";;;;;;AAQA;;;;AACA;;;;AACA;;;;AAEA;AACA;AACA;;AAEA,IAAIA,WAAW,gBAAMC,MAAN,CAAaC,MAA5B;AAAA,IACIC,WAAW,gBAAMF,MAAN,CAAaG,MAD5B;AAAA,IAEIC,YAAY,gBAAMJ,MAAN,CAAaK,OAF7B,C,CAhBA;;;;;;;;AAoBA,SAASC,KAAT,CAAeC,CAAf,EAAkB;AACd,WAAOH,UAAUI,KAAV,CAAgBD,CAAhB,CAAP;AACH;;AAED;AACA,SAASE,cAAT,GAA0B;AACtB,QAAIC,QAAQ,EAAZ;AAAA,QACIC,WAAW,SAAXA,QAAW,IAAK;AACZD,gBAAQA,MAAME,MAAN,CAAaC,CAAb,CAAR;AACH,KAHL;AAAA,QAIIC,WAAW,SAAXA,QAAW;AAAA,eAAMJ,KAAN;AAAA,KAJf;AAAA,QAKIK,OAAO,SAAEC,IAAF,CAAOC,IAAP,EAAaC,GAAb,CAAiBP,QAAjB,CALX;AAMA,WAAOI,KAAKI,IAAL,CAAUb,MAAM,GAAN,EAAWc,SAAX,CAAqBL,IAArB,EAA2BM,MAA3B,EAAV,EAA+CC,GAA/C,GAAqDJ,GAArD,CAAyDJ,QAAzD,CAAP;AACH;;AAED;AACA,SAASS,eAAT,GAA2B;AACvB,QAAIb,QAAQ,EAAZ;AAAA,QACIC,WAAW,SAAXA,QAAW,IAAK;AACZD,cAAMG,EAAE,CAAF,CAAN,IAAcA,EAAE,CAAF,CAAd;AACH,KAHL;AAAA,QAIIC,WAAW,SAAXA,QAAW;AAAA,eAAMJ,KAAN;AAAA,KAJf;AAAA,QAKIc,YAAYtB,SACPuB,QADO,CACEnB,MAAM,GAAN,CADF,EAEPa,IAFO,CAEF,SAAEH,IAAF,CAAOC,IAAP,CAFE,EAGPC,GAHO,CAGHP,QAHG,CALhB;AASA,WAAOa,UACFC,QADE,CACOnB,MAAM,GAAN,EAAWa,IAAX,CAAgBK,SAAhB,EAA2BH,MAA3B,EADP,EAEFC,GAFE,GAGFJ,GAHE,CAGEJ,QAHF,CAAP;AAIH;;AAED;AACA,SAASG,IAAT,GAAgB;AACZ,WAAOlB,SACF2B,EADE,CACCxB,QADD,EAEFwB,EAFE,CAECpB,MAAM,MAAN,EAAcqB,WAAd,CAA0B,IAA1B,CAFD,EAGFD,EAHE,CAGCpB,MAAM,MAAN,EAAcqB,WAAd,CAA0B,IAA1B,CAHD,EAIFD,EAJE,CAICpB,MAAM,OAAN,EAAeqB,WAAf,CAA2B,KAA3B,CAJD,EAKFD,EALE,CAKCpB,MAAM,GAAN,EAAWc,SAAX,CAAqB,SAAEJ,IAAF,CAAOP,cAAP,CAArB,EAA6CgB,QAA7C,CAAsDnB,MAAM,GAAN,CAAtD,CALD,EAMFoB,EANE,CAMCpB,MAAM,GAAN,EAAWc,SAAX,CAAqB,SAAEJ,IAAF,CAAOO,eAAP,CAArB,EAA8CE,QAA9C,CAAuDnB,MAAM,GAAN,CAAvD,CAND,CAAP;AAOH;;AAED;kBACe;AACXsB,WAAO,eAASC,MAAT,EAAiB;AACpB,YAAIC,WAAW,CAAC,MAAD,EAAS,OAAT,EAAkB,MAAlB,EAA0B,GAA1B,EAA+B,GAA/B,EAAoC,GAApC,EAAyC,GAAzC,EAA8C,GAA9C,EAAmD,GAAnD,CAAf;AAAA,YACIC,YAAY,iBACPC,SADO,CACGF,QADH,EAEPG,kBAFO,CAEY,gBAAMC,OAFlB,CADhB;;AAKA,eAAOH,UAAUI,KAAV,CAAgBlB,OAAOQ,QAAP,CAAgB,SAAEW,GAAlB,CAAhB,EAAwCR,KAAxC,CAA8CC,MAA9C,EAAsD,CAAtD,CAAP;AACH;AARU,C","file":"jsonparser.js","sourcesContent":["/*\r\n * Parsec\r\n * https://github.com/d-plaindoux/parsec\r\n *\r\n * Copyright (c) 2016 Didier Plaindoux\r\n * Licensed under the LGPL2 license.\r\n */\r\n\r\nimport genlex from '../../genlex/genlex.js';\r\nimport token from '../../genlex/token';\r\nimport {F} from '../../parsec/index';\r\n\r\n//\r\n// Facilities\r\n//\r\n\r\nvar tkNumber = token.parser.number,\r\n    tkString = token.parser.string,\r\n    tkKeyword = token.parser.keyword;\r\n\r\nfunction tkKey(s) {\r\n    return tkKeyword.match(s);\r\n}\r\n\r\n// unit -> Parser ? Token\r\nfunction arrayOrNothing() {\r\n    var value = [],\r\n        addValue = e => {\r\n            value = value.concat(e);\r\n        },\r\n        getValue = () => value,\r\n        item = F.lazy(expr).map(addValue);\r\n    return item.then(tkKey(',').thenRight(item).optrep()).opt().map(getValue);\r\n}\r\n\r\n// unit -> Parser ? Token\r\nfunction objectOrNothing() {\r\n    var value = {},\r\n        addValue = e => {\r\n            value[e[0]] = e[1];\r\n        },\r\n        getValue = () => value,\r\n        attribute = tkString\r\n            .thenLeft(tkKey(':'))\r\n            .then(F.lazy(expr))\r\n            .map(addValue);\r\n    return attribute\r\n        .thenLeft(tkKey(',').then(attribute).optrep())\r\n        .opt()\r\n        .map(getValue);\r\n}\r\n\r\n// unit -> Parser ? Token\r\nfunction expr() {\r\n    return tkNumber\r\n        .or(tkString)\r\n        .or(tkKey('null').thenReturns(null))\r\n        .or(tkKey('true').thenReturns(true))\r\n        .or(tkKey('false').thenReturns(false))\r\n        .or(tkKey('[').thenRight(F.lazy(arrayOrNothing)).thenLeft(tkKey(']')))\r\n        .or(tkKey('{').thenRight(F.lazy(objectOrNothing)).thenLeft(tkKey('}')));\r\n}\r\n\r\n//const parse =\r\nexport default {\r\n    parse: function(source) {\r\n        var keywords = ['null', 'false', 'true', '{', '}', '[', ']', ':', ','],\r\n            tokenizer = genlex\r\n                .generator(keywords)\r\n                .tokenBetweenSpaces(token.builder);\r\n\r\n        return tokenizer.chain(expr().thenLeft(F.eos)).parse(source, 0);\r\n    },\r\n};\r\n"]}