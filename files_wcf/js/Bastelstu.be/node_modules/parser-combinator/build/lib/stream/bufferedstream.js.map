{"version":3,"sources":["../../../src/lib/stream/bufferedstream.js"],"names":["BufferedStream","source","cache","index","location","endOfStream","self","get","factory"],"mappings":";;;;;;;;AAOA;;;;;;;;;;+eAPA;;;;;;;;;AASA;;;IAGMA,c;;;AACF,4BAAYC,MAAZ,EAAoB;AAAA;;AAAA;;AAEhB,cAAKA,MAAL,GAAcA,MAAd;AACA,cAAKC,KAAL,GAAa,EAAb;AAHgB;AAInB;;;;iCAEQC,K,EAAO;AACZ,mBAAO,KAAKF,MAAL,CAAYG,QAAZ,CAAqBD,KAArB,CAAP;AACH;;AAED;;;;oCACYA,K,EAAO;AACf,mBAAO,KAAKF,MAAL,CAAYI,WAAZ,CAAwBF,KAAxB,CAAP;AACH;;AAED;;;;4BACIA,K,EAAO;AACP,gBAAIG,OAAO,IAAX;;AAEA,gBAAI,CAACA,KAAKJ,KAAL,CAAWC,KAAX,CAAL,EAAwB;AACpBG,qBAAKJ,KAAL,CAAWC,KAAX,IAAoBG,KAAKL,MAAL,CAAYM,GAAZ,CAAgBJ,KAAhB,CAApB;AACH;;AAED,mBAAOG,KAAKJ,KAAL,CAAWC,KAAX,CAAP;AACH;;;;;;AAGL,SAASK,OAAT,CAAiBP,MAAjB,EAAyB;AACrB,WAAO,IAAID,cAAJ,CAAmBC,MAAnB,CAAP;AACH;;kBAEcO,O","file":"bufferedstream.js","sourcesContent":["/*\r\n * Parsec\r\n * https://github.com/d-plaindoux/parsec\r\n *\r\n * Copyright (c) 2016 Didier Plaindoux\r\n * Licensed under the LGPL2 license.\r\n */\r\nimport Stream from './stream';\r\n\r\n/**\r\n * Buffered stream class\r\n */\r\nclass BufferedStream extends Stream {\r\n    constructor(source) {\r\n        super();\r\n        this.source = source;\r\n        this.cache = {};\r\n    }\r\n\r\n    location(index) {\r\n        return this.source.location(index);\r\n    }\r\n\r\n    // BufferedStream 'a => unit -> boolean\r\n    endOfStream(index) {\r\n        return this.source.endOfStream(index);\r\n    }\r\n\r\n    // override, BufferedStream 'a => number -> Try 'a\r\n    get(index) {\r\n        var self = this;\r\n\r\n        if (!self.cache[index]) {\r\n            self.cache[index] = self.source.get(index);\r\n        }\r\n\r\n        return self.cache[index];\r\n    }\r\n}\r\n\r\nfunction factory(source) {\r\n    return new BufferedStream(source);\r\n}\r\n\r\nexport default factory;\r\n"]}