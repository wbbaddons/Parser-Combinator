{"version":3,"sources":["../../../src/lib/genlex/token.js"],"names":["Token","none","TKKeyword","value","some","TKIdent","TKNumber","TKString","TKChar","literal","tokenise","parse","input","index","get","map","accept","token","orLazyElse","reject","location","lazyRecoverWith","builder","keyword","ident","number","string","char","parser"],"mappings":"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","file":"token.js","sourcesContent":["/*\r\n * Parsec\r\n * https://github.com/d-plaindoux/parsec\r\n *\r\n * Copyright (c) 2016 Didier Plaindoux\r\n * Licensed under the LGPL2 license.\r\n */\r\n\r\nimport response from '../parsec/response';\r\nimport option from '../data/option';\r\nimport F from '../parsec/flow-bundle';\r\n\r\nclass Token {\r\n    constructor() {}\r\n\r\n    keyword() {\r\n        return option.none();\r\n    }\r\n\r\n    ident() {\r\n        return option.none();\r\n    }\r\n\r\n    number() {\r\n        return option.none();\r\n    }\r\n\r\n    string() {\r\n        return option.none();\r\n    }\r\n\r\n    char() {\r\n        return option.none();\r\n    }\r\n}\r\n\r\nclass TKKeyword extends Token {\r\n    constructor(value) {\r\n        super();\r\n        this.value = value;\r\n    }\r\n\r\n    keyword() {\r\n        return option.some(this.value);\r\n    }\r\n}\r\n\r\nclass TKIdent extends Token {\r\n    constructor(value) {\r\n        super();\r\n        this.value = value;\r\n    }\r\n\r\n    ident() {\r\n        return option.some(this.value);\r\n    }\r\n}\r\n\r\nclass TKNumber extends Token {\r\n    constructor(value) {\r\n        super();\r\n        this.value = value;\r\n    }\r\n\r\n    number() {\r\n        return option.some(this.value);\r\n    }\r\n}\r\n\r\nclass TKString extends Token {\r\n    constructor(value) {\r\n        super();\r\n        this.value = value;\r\n    }\r\n\r\n    string() {\r\n        return option.some(this.value);\r\n    }\r\n}\r\n\r\nclass TKChar extends Token {\r\n    constructor(value) {\r\n        super();\r\n        this.value = value;\r\n    }\r\n\r\n    char() {\r\n        return option.some(this.value);\r\n    }\r\n}\r\n\r\n// (Token -> Option 'a) -> Parser 'a Token\r\nfunction literal(tokenise) {\r\n    return F.parse((input, index) =>\r\n        input\r\n            .get(index)\r\n            .map(value =>\r\n                tokenise(value)\r\n                    .map(token =>\r\n                        response.accept(token, input, index + 1, true)\r\n                    )\r\n                    .orLazyElse(() =>\r\n                        response.reject(input.location(index), false)\r\n                    )\r\n            )\r\n            .lazyRecoverWith(() =>\r\n                response.reject(input.location(index), false)\r\n            )\r\n    );\r\n}\r\n\r\nconst token = {\r\n    builder: {\r\n        keyword: value => new TKKeyword(value),\r\n        ident: value => new TKIdent(value),\r\n        number: value => new TKNumber(value),\r\n        string: value => new TKString(value),\r\n        char: value => new TKChar(value),\r\n    },\r\n    parser: {\r\n        keyword: literal(token => token.keyword()),\r\n        ident: literal(token => token.ident()),\r\n        number: literal(token => token.number()),\r\n        string: literal(token => token.string()),\r\n        char: literal(token => token.char()),\r\n    },\r\n};\r\n\r\nexport default token;\r\n"]}